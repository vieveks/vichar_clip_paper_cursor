$ cd "D:\vivek_projects\vichar\Paper_related_work\clip_paper_1\experiments\vichar_clip_paper_cursor"; conda activate pytorch_5070ti; python train_clip_hf_dataset_fast.py --data_dir data/hf_chess_puzzles --train_subset_size 100000 --val_subset_size 12500 --epochs 20 --batch_size 256 --lr 5e-5 --max_grad_norm 1.0 --fp16 --num_workers 4 --out_dir runs/clip_hf_chess_100k_20epochs_fixed
2025-11-22 23:50:39,636 - INFO - Using device: cuda
2025-11-22 23:50:39,638 - INFO - GPU: NVIDIA GeForce RTX 5070 Ti
2025-11-22 23:50:39,638 - INFO - VRAM: 17.09 GB
2025-11-22 23:50:39,638 - INFO - Loading dataset from data/hf_chess_puzzles
2025-11-22 23:50:39,850 - INFO - Creating subsets: Train=100000, Val=12500
2025-11-22 23:50:39,850 - INFO - Dataset sizes - Train: 99999, Val: 12500
2025-11-22 23:50:39,851 - INFO - Loading model: ViT-B-32 with pretrained weights: laion2B-s34B-b79K
2025-11-22 23:50:39,851 - INFO - Parsing model identifier. Schema: None, Identifier: ViT-B-32
2025-11-22 23:50:39,851 - INFO - Loaded built-in ViT-B-32 model config.
2025-11-22 23:50:40,128 - INFO - Instantiating model architecture: CLIP
2025-11-22 23:50:40,863 - INFO - Loading full pretrained weights from: C:\Users\admin\.cache\huggingface\hub\models--laion--CLIP-ViT-B-32-laion2B-s34B-b79K\snapshots\1a25a446712ba5ee05982a381eed697ef9b435cf\open_clip_model.safetensors
2025-11-22 23:50:41,531 - INFO - Final image preprocessing configuration set: {'size': (224, 224), 'mode': 'RGB', 'mean': (0.48145466, 0.4578275, 0.40821073), 'std': (0.26862954, 0.26130258, 0.27577711), 'interpolation': 'bicubic', 'resize_mode': 'shortest', 'fill_color': 0}
2025-11-22 23:50:41,531 - INFO - Model ViT-B-32 creation process complete.
2025-11-22 23:50:41,532 - INFO - Parsing tokenizer identifier. Schema: None, Identifier: ViT-B-32
2025-11-22 23:50:41,532 - INFO - Attempting to load config from built-in: ViT-B-32
2025-11-22 23:50:41,532 - INFO - Using default SimpleTokenizer.
2025-11-22 23:50:41,584 - INFO - Training metadata saved to runs\clip_hf_chess_100k_20epochs_fixed\training_metadata.json
2025-11-22 23:50:41,584 - INFO - 
============================================================
2025-11-22 23:50:41,584 - INFO - Starting fast training...
2025-11-22 23:50:41,584 - INFO - ============================================================
2025-11-22 23:50:41,584 - INFO - 
============================================================
2025-11-22 23:50:41,584 - INFO - Epoch 1/20
2025-11-22 23:50:41,584 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:49<00:00,  2.30it/s, loss=0.0288]
Validating: 100%|##########| 49/49 [00:48<00:00,  1.00it/s]
2025-11-22 23:54:20,222 - INFO - Epoch 1 - Train Loss: 1.8868, Val Loss: 0.0521
2025-11-22 23:54:21,559 - INFO - [SUCCESS] Saved best model (val_loss: 0.0521)
2025-11-22 23:54:23,016 - INFO - 
============================================================
2025-11-22 23:54:23,016 - INFO - Epoch 2/20
2025-11-22 23:54:23,016 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:59<00:00,  2.18it/s, loss=0.0024]
Validating: 100%|##########| 49/49 [00:34<00:00,  1.44it/s]
2025-11-22 23:57:56,782 - INFO - Epoch 2 - Train Loss: 0.0356, Val Loss: 0.0143
2025-11-22 23:57:57,994 - INFO - [SUCCESS] Saved best model (val_loss: 0.0143)
2025-11-22 23:57:59,147 - INFO - 
============================================================
2025-11-22 23:57:59,147 - INFO - Epoch 3/20
2025-11-22 23:57:59,147 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:54<00:00,  2.23it/s, loss=0.0095]
Validating: 100%|##########| 49/49 [00:48<00:00,  1.01it/s]
2025-11-23 00:01:42,678 - INFO - Epoch 3 - Train Loss: 0.0165, Val Loss: 0.0104
2025-11-23 00:01:43,876 - INFO - [SUCCESS] Saved best model (val_loss: 0.0104)
2025-11-23 00:01:45,042 - INFO - 
============================================================
2025-11-23 00:01:45,043 - INFO - Epoch 4/20
2025-11-23 00:01:45,043 - INFO - ============================================================
Training: 100%|##########| 391/391 [03:21<00:00,  1.94it/s, loss=0.0139]
Validating: 100%|##########| 49/49 [00:38<00:00,  1.29it/s]
2025-11-23 00:05:44,998 - INFO - Epoch 4 - Train Loss: 0.0098, Val Loss: 0.0046
2025-11-23 00:05:46,305 - INFO - [SUCCESS] Saved best model (val_loss: 0.0046)
2025-11-23 00:05:47,683 - INFO - 
============================================================
2025-11-23 00:05:47,683 - INFO - Epoch 5/20
2025-11-23 00:05:47,683 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:55<00:00,  2.22it/s, loss=0.0001]
Validating: 100%|##########| 49/49 [00:48<00:00,  1.01it/s]
2025-11-23 00:09:31,992 - INFO - Epoch 5 - Train Loss: 0.0070, Val Loss: 0.0051
2025-11-23 00:09:33,309 - INFO - 
============================================================
2025-11-23 00:09:33,309 - INFO - Epoch 6/20
2025-11-23 00:09:33,309 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:29<00:00,  2.62it/s, loss=0.0021]
Validating: 100%|##########| 49/49 [00:33<00:00,  1.45it/s]
2025-11-23 00:12:36,107 - INFO - Epoch 6 - Train Loss: 0.0062, Val Loss: 0.0054
2025-11-23 00:12:37,293 - INFO - 
============================================================
2025-11-23 00:12:37,293 - INFO - Epoch 7/20
2025-11-23 00:12:37,294 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:40<00:00,  2.43it/s, loss=0.0001]
Validating: 100%|##########| 49/49 [00:48<00:00,  1.01it/s]
2025-11-23 00:16:06,664 - INFO - Epoch 7 - Train Loss: 0.0055, Val Loss: 0.0026
2025-11-23 00:16:07,902 - INFO - [SUCCESS] Saved best model (val_loss: 0.0026)
2025-11-23 00:16:09,207 - INFO - 
============================================================
2025-11-23 00:16:09,207 - INFO - Epoch 8/20
2025-11-23 00:16:09,207 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:54<00:00,  2.24it/s, loss=0.0066]
Validating: 100%|##########| 49/49 [00:34<00:00,  1.43it/s]
2025-11-23 00:19:37,766 - INFO - Epoch 8 - Train Loss: 0.0053, Val Loss: 0.0040
2025-11-23 00:19:38,941 - INFO - 
============================================================
2025-11-23 00:19:38,941 - INFO - Epoch 9/20
2025-11-23 00:19:38,941 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:33<00:00,  2.55it/s, loss=0.0006]
Validating: 100%|##########| 49/49 [00:48<00:00,  1.02it/s]
2025-11-23 00:23:00,809 - INFO - Epoch 9 - Train Loss: 0.0039, Val Loss: 0.0030
2025-11-23 00:23:01,997 - INFO - 
============================================================
2025-11-23 00:23:01,997 - INFO - Epoch 10/20
2025-11-23 00:23:01,997 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:33<00:00,  2.55it/s, loss=0.0001]
Validating: 100%|##########| 49/49 [00:33<00:00,  1.45it/s]
2025-11-23 00:26:09,074 - INFO - Epoch 10 - Train Loss: 0.0034, Val Loss: 0.0038
2025-11-23 00:26:10,239 - INFO - 
============================================================
2025-11-23 00:26:10,239 - INFO - Epoch 11/20
2025-11-23 00:26:10,239 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:40<00:00,  2.44it/s, loss=0.0029]
Validating: 100%|##########| 49/49 [00:47<00:00,  1.02it/s]
2025-11-23 00:29:38,451 - INFO - Epoch 11 - Train Loss: 0.0041, Val Loss: 0.0037
2025-11-23 00:29:39,861 - INFO - 
============================================================
2025-11-23 00:29:39,861 - INFO - Epoch 12/20
2025-11-23 00:29:39,862 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:32<00:00,  2.56it/s, loss=0.0000]
Validating: 100%|##########| 49/49 [00:33<00:00,  1.45it/s]
2025-11-23 00:32:46,518 - INFO - Epoch 12 - Train Loss: 0.0037, Val Loss: 0.0024
2025-11-23 00:32:47,802 - INFO - [SUCCESS] Saved best model (val_loss: 0.0024)
2025-11-23 00:32:49,195 - INFO - 
============================================================
2025-11-23 00:32:49,195 - INFO - Epoch 13/20
2025-11-23 00:32:49,195 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:47<00:00,  2.34it/s, loss=0.0000]
Validating: 100%|##########| 49/49 [00:37<00:00,  1.29it/s]
2025-11-23 00:36:14,414 - INFO - Epoch 13 - Train Loss: 0.0032, Val Loss: 0.0019
2025-11-23 00:36:15,560 - INFO - [SUCCESS] Saved best model (val_loss: 0.0019)
2025-11-23 00:36:16,690 - INFO - 
============================================================
2025-11-23 00:36:16,690 - INFO - Epoch 14/20
2025-11-23 00:36:16,691 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:37<00:00,  2.48it/s, loss=0.0001]
Validating: 100%|##########| 49/49 [00:33<00:00,  1.47it/s]
2025-11-23 00:39:27,629 - INFO - Epoch 14 - Train Loss: 0.0043, Val Loss: 0.0025
2025-11-23 00:39:28,811 - INFO - 
============================================================
2025-11-23 00:39:28,811 - INFO - Epoch 15/20
2025-11-23 00:39:28,811 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:18<00:00,  2.83it/s, loss=0.0001]
Validating: 100%|##########| 49/49 [00:36<00:00,  1.34it/s]
2025-11-23 00:42:23,828 - INFO - Epoch 15 - Train Loss: 0.0013, Val Loss: 0.0005
2025-11-23 00:42:25,289 - INFO - [SUCCESS] Saved best model (val_loss: 0.0005)
2025-11-23 00:42:26,652 - INFO - 
============================================================
2025-11-23 00:42:26,652 - INFO - Epoch 16/20
2025-11-23 00:42:26,652 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:42<00:00,  2.40it/s, loss=0.0001]
Validating: 100%|##########| 49/49 [00:33<00:00,  1.45it/s]
2025-11-23 00:45:43,290 - INFO - Epoch 16 - Train Loss: 0.0057, Val Loss: 0.0031
2025-11-23 00:45:44,612 - INFO - 
============================================================
2025-11-23 00:45:44,613 - INFO - Epoch 17/20
2025-11-23 00:45:44,613 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:22<00:00,  2.75it/s, loss=0.0001]
Validating: 100%|##########| 49/49 [00:36<00:00,  1.36it/s]
2025-11-23 00:48:42,839 - INFO - Epoch 17 - Train Loss: 0.0020, Val Loss: 0.0025
2025-11-23 00:48:44,051 - INFO - 
============================================================
2025-11-23 00:48:44,051 - INFO - Epoch 18/20
2025-11-23 00:48:44,051 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:20<00:00,  2.78it/s, loss=0.0167]
Validating: 100%|##########| 49/49 [00:33<00:00,  1.46it/s]
2025-11-23 00:51:38,290 - INFO - Epoch 18 - Train Loss: 0.0033, Val Loss: 0.0083
2025-11-23 00:51:39,560 - INFO - 
============================================================
2025-11-23 00:51:39,560 - INFO - Epoch 19/20
2025-11-23 00:51:39,560 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:18<00:00,  2.83it/s, loss=0.0000]
Validating: 100%|##########| 49/49 [00:33<00:00,  1.47it/s]
2025-11-23 00:54:31,039 - INFO - Epoch 19 - Train Loss: 0.0037, Val Loss: 0.0029
2025-11-23 00:54:32,286 - INFO - 
============================================================
2025-11-23 00:54:32,286 - INFO - Epoch 20/20
2025-11-23 00:54:32,286 - INFO - ============================================================
Training: 100%|##########| 391/391 [02:19<00:00,  2.81it/s, loss=0.0000]
Validating: 100%|##########| 49/49 [00:33<00:00,  1.45it/s]
2025-11-23 00:57:25,356 - INFO - Epoch 20 - Train Loss: 0.0022, Val Loss: 0.0007
2025-11-23 00:57:26,668 - INFO - 
[SUCCESS] Training complete!
2025-11-23 00:57:26,668 - INFO - Best validation loss: 0.0005
2025-11-23 00:57:26,668 - INFO - Results saved to: runs\clip_hf_chess_100k_20epochs_fixed